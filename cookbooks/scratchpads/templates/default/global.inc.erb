<?php
global $conf;
$conf["cron_safe_threshold"] = 0;
$conf["preprocess_css"] = 1;
$conf["preprocess_js"] = 1;
$conf["jquery_update_compression_type"] = "min";
$conf["jquery_update_jquery_cdn"] = "none";
$conf["error_level"] = ERROR_REPORTING_HIDE;
$conf["syslog_identity"] = $_SERVER["HTTP_HOST"];

// Cache
$conf["block_cache"] = TRUE;
$conf["cache"] = TRUE;
$conf["cache_lifetime"] = 3600;
$conf["page_cache_maximum_age"] = 10800;

// Memcache
include_once("/var/aegir/config/includes/memcache.inc");

// Varnish/Proxy
include_once("/var/aegir/config/includes/varnish.inc");

// Solr settings
include_once("/var/aegir/config/includes/solr.inc");

// Not everybody can run updates.
$update_free_access = 0;

// Set some PHP settings
ini_set("pcre.backtrack_limit", 10000000);
ini_set("pcre.recursion_limit", 10000000);
ini_set("session.cookie_lifetime", 604800);
ini_set("session.gc_maxlifetime", 604800);
ini_set("session.use_cookies", 1);

// Tweak the $databases array, setting the charset to utf8mb4
// and adding the GM3 database
include_once("/var/aegir/config/includes/databases.inc");

$conf['twitter_consumer_key'] = '<%= @twitter_consumer_key %>';
$conf['twitter_consumer_secret'] = '<%= @twitter_consumer_secret %>';
$conf['scratchpads_multilingual_contribute_ini'] = array(
  'key' => '<%= @scratchpads_multilingual_contribute_key %>',
  'uwho' => '<%= @scratchpads_multilingual_contribute_uwho %>'
);
$conf['scratchpads_gbif_registry_ini'] = array(
  'username' => '<%= @scratchpads_gbif_registry_username %>',
  'password' => '<%= @scratchpads_gbif_registry_password %>',
);
$conf['taverna_auth_token'] = '<%= @scratchpads_taverna_auth_token %>';

// Set the hosting_auto_pack settings
$conf['hosting_auto_pack_slave_name_starts'] = '<%= node.default['scratchpads']['hostname_prefix'] %>sp-app';
$conf['hosting_auto_pack_master_name_starts'] = '<%= node.default['scratchpads']['hostname_prefix'] %>sp-control';
$conf['hosting_scratchpads_db_name_starts'] = '<%= node.default['scratchpads']['hostname_prefix'] %>sp-data';
