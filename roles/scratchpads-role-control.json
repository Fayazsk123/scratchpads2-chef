{
  "name": "scratchpads-role-control",
  "description": "Main Aegir server role.",
  "default_attributes": {
    "chef_client": {
      "init_style": "systemd"
    },
    "gkrellmd": {
      "allowed_hosts": [
        "157.140.126.246",
        "monkey.nhm.ac.uk"
      ]
    },
    "percona": {
      "use_percona_repos": false,
      "apt_keyserver": "keyserver.ubuntu.com",
      "server": {
        "bind_address": "",
        "innodb_log_file_size": "100M",
        "group_concat_max_len": "4294967295",
        "innodb_file_format": "Barracuda"
      }
    },
    "php": {
      "conf_dir": "/etc/php5/apache2",
      "directives": {
        "memory_limit": "512M",
        "session.save_path": "/var/www/php-sessions",
        "realpath_cache_ttl": 3600,
        "realpath_cache_size": "10M",
        "opcache.memory_consumption": "256",
        "opcache.max_accelerated_files": 5000,
        "opcache.enable_file_override": 1
      },
      "ext_conf_dir": "/etc/php5/mods-available",
      "packages": [
        "php5",
        "php5-apcu",
        "php5-cli",
        "php5-curl",
        "php5-gd",
        "php5-gmp",
        "php5-intl",
        "php5-mcrypt",
        "php5-mysql",
        "php5-memcache",
        "php5-pecl-http",
        "php5-propro",
        "php5-raphf",
        "php-console-table"
      ]
    }
  },
  "override_attributes": {
    "apache": {
      "listen_addresses": [
        "127.0.0.1"
      ],
      "mpm": "prefork"
    },
    "percona": {
      "encrypted_data_bag_secret_file": "/vagrant/.chef/encrypted_data_bag_secret"
    },
    "postfix": {
      "inet-interfaces": "all",
      "mail_type": "master",
      "main": {
        "relayhost": "mailserver.nhm.ac.uk"
      }
    },
    "varnish": {
      "listen_port": "80",
      "conf_source": "default-varnish.erb",
      "conf_cookbook": "scratchpads",
      "vcl_generated": false
    }
  },
  "run_list": [
    "recipe[git]",
    "recipe[imagemagick]",
    "recipe[scratchpads]",
    "recipe[scratchpads::percona-server]",
    "recipe[scratchpads::webserver]",
    "recipe[scratchpads::postfix]",
    "recipe[scratchpads::aegir]",
    "recipe[scratchpads::nfs]",
    "recipe[scratchpads::varnish]",
    "recipe[scratchpads::mediawiki]"
  ]
}